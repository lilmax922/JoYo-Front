import{_ as F,b3 as L,b4 as N,b8 as D,a8 as x,r as J,$ as Y,c as S,b5 as E,j as c,a0 as _,a1 as o,l as a,d as s,Y as u,a3 as H,a4 as y,ak as U,a6 as l,R as $,k,a2 as Q,F as B,a9 as I,aa as h,b9 as G,a5 as K,ab as M,ac as W,s as X,t as Z,ai as T}from"./index.fa62bada.js";import{Q as v,a as ee}from"./QBreadcrumbs.1a9c2e9c.js";import{Q as te}from"./QChip.00e5ae2b.js";import{Q as ae}from"./QPage.51f21298.js";import{u as se}from"./use-quasar.88f90479.js";import{S as oe,a as ie}from"./swiper-slide.9c19cf4b.js";import{A as le}from"./pagination.min.c91b72d4.js";import{u as ne}from"./teamup.14e4bc5a.js";import{T as re}from"./TeamupCard.c967f87f.js";const ce=f=>(X("data-v-2e4db028"),f=f(),Z(),f),de={class:"container"},ue={class:"breadcrumb"},pe={id:"teamup_form"},me={class:"q-mb-lg"},_e={class:"nickname_area"},fe={class:"nickname"},ge={class:"title_area q-mt-md"},he={class:"text-h2"},ye={class:"content_area"},ve={class:"text-h4"},be={class:"icon_area q-mt-lg"},we={class:"type"},Pe={class:"date flex items-center"},xe={class:"time flex items-center"},Se={class:"people flex items-center"},ke={id:"search_for"},Qe={class:"row"},Be={class:"col-12"},Ie=ce(()=>a("div",{class:"title text-h4"},"YOU MAY LOOKING FOR",-1)),Te={class:"q-mt-lg"},qe={__name:"JoinTeamupPage",setup(f){const q=L(),C=N(),d=se(),b=D(),w=ne(),{isLoginHandler:z}=b,{getAllTeamups:V}=w,{_id:p}=x(b),{teamups:P}=x(w);V();const O=[le],g=J(!1),e=Y({_id:P._id||"",organizer:"",participant:[],date:"",time:"",hour:1,currentPeople:1,totalPeople:1,cardImage:void 0,types:[],title:"",content:"",loading:!1}),R=S(()=>P.value.filter(i=>i._id!==e._id&&i.types.some(n=>e.types.includes(n))));(async()=>{var i,n;try{const{data:t}=await E.get("/teamups/"+q.params.id);e._id=t.result._id,e.organizer=t.result.organizer,e.participant=t.result.participant,e.date=t.result.date,e.time=t.result.time,e.hour=t.result.hour,e.currentPeople=t.result.currentPeople,e.totalPeople=t.result.totalPeople,e.cardImage=t.result.cardImage,e.types=t.result.types,e.title=t.result.title,e.content=t.result.content,g.value=e.participant.includes(p.value),document.title="\u63EA\u904A | "+e.title}catch(t){d.notify({message:"\u8CC7\u6599\u53D6\u5F97\u5931\u6557",type:"negative",caption:((n=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:n.message)||"\u767C\u751F\u932F\u8AA4",position:"top"}),C.go(-1)}})();const j=S(()=>e.currentPeople===e.totalPeople),A=async()=>{if(p.value===e.organizer._id){d.notify({type:"negative",message:"\u7121\u6CD5\u52A0\u5165\u81EA\u5DF1\u767C\u8D77\u7684\u63EA\u5718"});return}if(!z())return;const i=async()=>{var t,m;try{await T.post("/teamups/"+e._id),d.notify({message:"\u53C3\u52A0\u6210\u529F",textColor:"primary",icon:"mdi-emoticon-happy-outline",color:"white"})}catch(r){d.notify({message:"\u8CC7\u6599\u53D6\u5F97\u5931\u6557",textColor:"secondary",color:"white",icon:"mdi-emoticon-dead-outline",caption:((m=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:m.message)||"\u767C\u751F\u932F\u8AA4"})}},n=async()=>{var t,m;try{await T.post("/teamups/"+e._id),d.notify({message:"\u53D6\u6D88\u6210\u529F",textColor:"primary",icon:"mdi-emoticon-happy-outline",color:"white"})}catch(r){d.notify({message:"\u8CC7\u6599\u53D6\u5F97\u5931\u6557",textColor:"secondary",color:"white",icon:"mdi-emoticon-dead-outline",caption:((m=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:m.message)||"\u767C\u751F\u932F\u8AA4"})}};e.participant.includes(p.value)?(e.currentPeople--,await n(),e.participant.splice(e.participant.indexOf(p.value,1)),e.loading=!1,g.value=!1):(e.currentPeople++,await i(),e.participant.push(p.value),e.loading=!1,g.value=!0)};return(i,n)=>(c(),_(ae,{id:"jointeamup",padding:""},{default:o(()=>[a("div",de,[a("div",ue,[s(ee,null,{separator:o(()=>[s(u,{size:"1.5em",name:"chevron_right"})]),default:o(()=>[s(v,{icon:"mdi-home",to:"/"}),s(v,{label:"\u63EA\u5718\u7D44\u968A",to:"/searchTeamups"}),s(v,{label:e.title},null,8,["label"])]),_:1})]),a("section",pe,[s(G,{onSubmit:A,class:"teamup_wrap q-mt-xl"},{default:o(()=>[s(H,{class:"teamup_card",flat:""},{default:o(()=>[s(y,{class:"q-pa-xl row"},{default:o(()=>[s(y,{class:"col-xs-12 col-lg-5"},{default:o(()=>[s(U,{class:"card_img",src:e.cardImage},null,8,["src"])]),_:1}),s(y,{class:"info_area col-xs-12 col-lg-7"},{default:o(()=>[a("div",me,[a("span",_e,[s(u,{name:"mdi-human-greeting"}),a("span",fe,l(e.organizer.nickname),1)])]),a("div",ge,[a("div",he,l(e.title),1)]),s($,{class:"q-my-lg"}),a("div",ye,[a("div",ve,l(e.content),1)]),a("div",be,[a("div",we,[s(u,{name:"mdi-google-downasaur",class:"q-pr-sm"}),(c(!0),k(B,null,Q(e.types,t=>(c(),_(te,{key:t,color:"secondary",size:"md"},{default:o(()=>[K(" #"+l(t),1)]),_:2},1024))),128))]),a("div",Pe,[s(u,{name:"mdi-calendar-clock"}),a("div",null," \xA0 "+l(new Date(e.date).toLocaleDateString()),1)]),a("div",xe,[s(u,{name:"mdi-clock-time-four-outline"}),a("div",null,"\xA0 "+l(e.time),1)]),a("div",Se,[s(u,{name:"mdi-account-group"}),a("div",null," \xA0 "+l(e.currentPeople)+" / "+l(e.totalPeople)+" \u4EBA ",1)]),g.value?(c(),_(I,{key:1,class:"cancelBtn",type:"submit",label:"\u53D6\u6D88\u53C3\u52A0",disable:e.loading},null,8,["disable"])):(c(),_(I,{key:0,class:"joinBtn",type:"submit",label:e.currentPeople===e.totalPeople?"\u4EBA\u6578\u5DF2\u6EFF":"\u53C3\u52A0\u63EA\u5718",disable:h(j)},null,8,["label","disable"]))])]),_:1})]),_:1})]),_:1})]),_:1})]),a("section",ke,[a("div",Qe,[a("div",Be,[Ie,a("div",Te,[s(h(oe),{class:"mySwiper",modules:O,autoplay:{delay:3e3,disableOnInteraction:!1},slidesPerView:1,spaceBetween:30,breakpoints:{576:{slidesPerView:1,spaceBetween:20},768:{slidesPerView:2,spaceBetween:30},1024:{slidesPerView:3,spaceBetween:40},1500:{slidesPerView:4,spaceBetween:50}}},{default:o(()=>[(c(!0),k(B,null,Q(h(R),t=>(c(),_(h(ie),{key:t},{default:o(()=>[s(re,M(W(t)),null,16)]),_:2},1024))),128))]),_:1})])])])])])]),_:1}))}};var Ne=F(qe,[["__scopeId","data-v-2e4db028"]]);export{Ne as default};
